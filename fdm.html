<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Numerical: Finite Difference Method</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Numerical
   </div>
   <div id="projectbrief">A code used to showcase numerical methods.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Finite Difference Method </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h3>Table of Contents</h3>
<ul>
<li><a href="#diffusion_fdm">Diffusion Equation</a></li>
<li><a href="#conv_diff_fdm">Convection-Diffusion Equation</a> &ndash;&gt; TODO</li>
<li><a href="#wave_fdm">Wave Equation</a> &ndash;&gt; TODO</li>
<li><a href="#dynamics_fdm">Dynamical Systems</a> &ndash;&gt; TODO <hr/>
</li>
</ul>
<h1><a class="anchor" id="diffusion_fdm"></a>
Diffusion Equation</h1>
<p>The Laplace/Poisson eqautions are just a steady-state variation of the time-dependent diffusion equation.</p>
<p>For the diffusion problem, we are using two different finite difference schemes for the temporal and spatial mesh.</p>
<h2>Centered Difference Scheme (space)</h2>
<p>Describe the concept here... see <a href="#references">[1]</a></p>
<h2>\(\Theta\)-Scheme (time)</h2>
<p>The important feature of this time discretization scheme is that we can implement one formula and then generate a family of well-known and widely used schemes, namely:</p>
<ul>
<li>\(\Theta\)=0 gives the Forward Euler scheme in time.</li>
<li>\(\Theta\)=1 gives the Backward Euler scheme in time.</li>
<li>\(\Theta\)=1/2 gives the Crank-Nicolson scheme in time.</li>
</ul>
<p>For a general 3D problem, the unifying \(\Theta\)-scheme is defined as</p>
<p class="formulaDsp">
\[ \frac{u^{n+1}_{i,j,k} - u^n_{i,j,k}} {\Delta t} = \Theta G\left(u^{n+1}_{i,j,k}\right) + \left(1-\Theta\right) G\left(u^{n}_{i,j,k}\right) \]
</p>
<p>where \(G\) corresponds to the centered difference scheme, i.e.</p>
<p class="formulaDsp">
\[ G(u^{n}_{i,j,k}) = \mathcal{F}_x\left(+u^n_{i-1,j,k}-2u^n_{i,j,k}+u^n_{i+1,j,k}\right) + \mathcal{F}_y\left(+u^n_{i,j-1,k}-2u^n_{i,j,k}+u^n_{i,j+1,k}\right) + \mathcal{F}_z\left(+u^n_{i,j,k-1}-2u^n_{i,j,k}+u^n_{i,j,k+1}\right) + \Delta t f^n_{i,j,k}. \]
</p>
<p>Where the Fourier coefficient are defined as:</p>
<p class="formulaDsp">
\[ \mathcal{F}_x=\frac{\alpha \Delta t}{\Delta x^2},\quad \mathcal{F}_y=\frac{\alpha \Delta t}{\Delta y^2},\quad \mathcal{F}_z=\frac{\alpha \Delta t}{\Delta z^2} \]
</p>
<p>A similar expression can be obtained for \(G(u^{n+1}_{0, j})\), by replacing \(n\) by \(n+1\).</p>
<p>Mapping the mesh nodes to a specific index \(i\), we can define the scheme on a matrix system of the form</p>
<p class="formulaDsp">
\[ \mathbf{A}\mathbf{u^{n+1}} = \mathbf{b} \]
</p>
<p>Where the coefficient of the coefficient matrix \(\mathbf{A}\) can be defined collecting all the unknown on the left side of the scheme equation.</p>
<p>For interior mesh nodes, the scheme leads to a coefficient matrix with entries:</p>
<p class="formulaDsp">
\[ A_{i, i-1} = -\mathcal{F}_{[]}\Theta,\quad A_{i,i}=1+2\mathcal{F}_{[]}\Theta, \quad A_{i, i+1} = -\mathcal{F}_{[]}\Theta \]
</p>
<p>where \(\mathcal{F}_{[]}\) represents the Fourier coefficient along one of the grid axis, i.e. \(\{x,y,z\}\).</p>
<p>For interior mesh nodes, the right-hand side (RHS) vector is then</p>
<p class="formulaDsp">
\[ b_i = u^n_i + \mathcal{F}_x\left(1-\Theta\right) \left(u^n_{i-1,j,k}-2u^n_{i,j,k}+u^n_{i+1,j,k}\right)+ \mathcal{F}_y\left(1-\Theta\right) \left(u^n_{i,j-1,k}-2u^n_{i,j,k}+u^n_{i,j+1,k}\right) + \mathcal{F}_z\left(1-\Theta\right) \left(u^n_{i,j,k-1}-2u^n_{i,j,k}+u^n_{i,j,k+1}\right) + \Delta t\Theta f^{n+1}_{i,j,k}+ \Delta t\left(1-\Theta\right) f^{n}_{i,j,k} \]
</p>
<h3>Mapping</h3>
<p>The mapping \(p=m(i,j,k)\) from a mesh node with indices \((i,j,k)\) to the corresponding unknown indice \(p\) in the equation system can be defined using</p>
<p class="formulaDsp">
\[ p = m(i, j, k) = i+ j(n_x + 1) + k((n_x + 1)(n_y+1))) \]
</p>
<p>This notation is obatined by numbering the mesh nodes from left ( \(x=x_\textrm{min}\)) to right ( \(x=x_\textrm{max}\)), to bottom ( \(y=y_\textrm{min}\)) to top ( \(y=y_\textrm{max}\)), and to back ( \(z=z_\textrm{min}\)) to front ( \(z=z_\textrm{max}\)).</p>
<p><a class="anchor" id="fig_mesh_fdm"></a></p><div class="image">
<img src="bloc.png" alt="bloc.png"/>
<div class="caption">
&lt;"Figure 1: A typical mesh for a bloc. The scene shows 
the bottom (orange), left (magenta) and front (blue) boundaries."&gt;</div></div>
 <h3>Heterogeneous Media</h3>
<p>For a spatially-dependent diffusion coefficient \(\alpha=\alpha(x,y,z)\), the diffusion equation becomes</p>
<p class="formulaDsp">
\[ \frac{\partial u}{\partial t} = \nabla\left(\alpha(x,y,z)\nabla u\right) + f(x,y,z,t) \]
</p>
<p>Which give the following discretized version for a line (1D)</p>
<p class="formulaDsp">
\[ \frac{u_i^{n+1}-u^n_i}{\Delta t} = \Theta\frac{1}{\Delta x^2}\left( \alpha_{i+1/2}\left(u^{n+1}_{i+1}-u^{n+1}_i\right)- \alpha_{i-1/2}\left(u^{n+1}_{i}-u^{n+1}_{i+1}\right)\right)+ \left(1-\Theta\right)\frac{1}{\Delta x^2}\left( \alpha_{i+1/2}\left(u^{n}_{i+1}-u^{n}_i\right)- \alpha_{i-1/2}\left(u^{n}_{i}-u^{n}_{i+1}\right)\right)+ \Theta f^{n+1}_i + \left(1-\Theta\right)f^n_i \]
</p>
<p>where</p>
<p class="formulaDsp">
\[ \alpha_{i+1/2} = \frac{1}{2}\left(\alpha_i+\alpha_{i+1}\right) \]
</p>
<p>and</p>
<p class="formulaDsp">
\[ \alpha_{i-1/2} = \frac{1}{2}\left(\alpha_i+\alpha_{i-1}\right) \]
</p>
<p>are the arithmetic means of \(\alpha(x,y,z)\).</p>
<h2>Boundary Conditions</h2>
<h3>Dirichlet</h3>
<p>At the Dirichelt boundary condition we fix \(u\) at the boundary. For example, on the left boundary of a line (1D), we have the following discretized Dirichlet boundary condition:</p>
<p class="formulaDsp">
\[ u^n_{0} = u_d \]
</p>
<p>For a constant diffusion coefficient, the coefficient matrix and RHS vector for the first two-rows would then be updated such that:</p>
<p class="formulaDsp">
\[ \left( \begin{array}{cccc} 1 &amp; 0 &amp; 0 &amp; \ldots\\ 0 &amp; 1+2\Theta\mathcal{F}_x &amp; -\Theta\mathcal{F}_x &amp; \ldots\\ \vdots &amp; \vdots &amp; \vdots &amp; \ddots \end{array} \right) \left( \begin{array}{c} u^{n+1}_0\\u^{n+1}_1\\ \vdots \end{array} \right) = \left( \begin{array}{c} u_d\\b_1\\ \vdots \end{array} \right) \]
</p>
<p>where \(b_1\) is</p>
<p class="formulaDsp">
\[ b_1 = u^n_1 + \mathcal{F}_x \left(1-\Theta\right)\left(u^n_{2}-2u^n_1+u^n_0\right) + \Delta t\Theta f^{n+1}_1 + \Delta t\left(1-\Theta\right)f^n_i \]
</p>
<h3>Neumann</h3>
<p>A natural approximation to the normal derivative is a one sided difference, for example, on the left boundary of a rectangle (2D), and using a constant diffusion coefficient \(\alpha\) we have the following discretized Neumann boundary condition:</p>
<p class="formulaDsp">
\[ \frac{\partial u}{\partial x} \approx \frac{u^n_{-1, j} - u^n_{1, j}}{2\Delta x} = g^n_{0,j} \]
</p>
<p>where \(g^n_{0,j,k}\) is the set value at the spatial node \(\{i,j,k\}\).</p>
<p>Note that the value \(u^n_{-1, j, k}\) is not well defined and need to be eliminated from the system of equations. This can be achieved substituting the Neumann boundary condition in the centered difference scheme, i.e.</p>
<p class="formulaDsp">
\[ \frac{u^{n+1}_{0,j}-u^{n}_{0,j}}{\Delta t} = \Theta G(u^{n+1}_{0, j}) + \left(1-\Theta\right)G(u^{n}_{0, j}) \]
</p>
<p>where</p>
<p class="formulaDsp">
\[ G(u^{n}_{0, j}) = \mathcal{F}_x\left(\left(2g^n_{0,j}\Delta x+u^n_{1,j}\right) -2u^n_{0,j}+u^n_{1,j}\right) + \mathcal{F}_y\left(u^n_{0,j-1}-2u^n_{0,j}+u^n_{0,j+1}\right)+ \Delta t f^n_{0, j}. \]
</p>
<p>A similar expression can be obtained for \(G(u^{n+1}_{0, j})\), by replacing \(n\) by \(n+1\).</p>
<p>The coefficient matrix and RHS vector for the fifth row of a 4 by 3 rectangular grid would then be updated such that:</p>
<p class="formulaDsp">
\[ [2 \Theta\mathcal{F}_x, -2\Theta Fx, 0, 0, \dots] [u^{n+1}_5] = b_5 \]
</p>
<p>where \(b_5\) is</p>
<p class="formulaDsp">
\[ b_5 = u^n_5+\left(1-\Theta\right)\left(\mathcal{F}_x\left(2u^n_6 -2u^n_5\right)+ \mathcal{F}_y\left(u^n_0 - 2u^n_5 + u^n_{10}\right)\right) + \Theta\left(\Delta tf^{n+1}_5+2\mathcal{F}_x\Delta xg^{n+1}_5\right)+ \left(1-\Theta\right)\left(\Delta tf^{n}_5+ 2\mathcal{F}_x\Delta xg^{n}_5\right) \]
</p>
<p>In order to keep the coefficient matrix symmetric, one may choose to scale the fifth row of the augmented system by 0.5, which gives:</p>
<p class="formulaDsp">
\[ [\Theta\mathcal{F}_x, -\Theta Fx, 0, 0, \dots] [u^{n+1}_5] = b_5 \]
</p>
<p>where \(b_5\) is</p>
<p class="formulaDsp">
\[ b_5 = \frac{1}{2}\left( u^n_5+\left(1-\Theta\right)\left(\mathcal{F}_x\left(2u^n_6 -2u^n_5\right)+ \mathcal{F}_y\left(u^n_0 - 2u^n_5 + u^n_{10}\right)\right) + \Theta\left(\Delta tf^{n+1}_5+2\mathcal{F}_x\Delta xg^{n+1}_5\right)+ \left(1-\Theta\right)\left(\Delta tf^{n}_5+ 2\mathcal{F}_x\Delta xg^{n}_5\right)\right) \]
</p>
<p><b>Note that the coefficient matrix may not be symmetric for heterogeous media.</b></p>
<p>At corner points, the norm vector is not well defined. We use average of two directional derivatives to get an approximation.</p>
<p>Taking (0, 0) as an example, we have ...</p>
<p class="formulaDsp">
\[ \begin{align} u_{-1, 0} - u_{1, 0} &amp;= 2\Delta x g_{1,1}\\ u_{0, -1} - u_{0, 1} &amp;= 2\Delta x g_{1,1} \end{align} \]
</p>
<h2>Nonlinear Problems</h2>
<p>There three possible approaches:</p>
<ol type="1">
<li>Discretize the problem in time and linearize the time-discrete (stationary) PDE problem at each time level into a sequence of linear PDE problems.</li>
<li>Discretize the problem in time and space and solve the resulting nonlinear algebraic equations at each time level.</li>
<li>Operator splitting.</li>
</ol>
<h3>First approach (PDE level)</h3>
<p>Linearizing time-discrete PDEs directly prior to discretization in space. In this case we can use either the Picard or Newton method for implicit shemes (backward Euler of Crank-Nicolson). For the forward Euler method, we can directly introduce the nonlinear term in the discretized equation. The disadvantage of the explicit method is the strict stability criterion.</p>
<h3>Second approach (Algebraic level)</h3>
<p>Carry out the discretization in space of the time-discrete nonlinear PDE problem and get a system of nonlinear algebraic equations.</p>
<h3>Third approach</h3>
<h3>Picard Method</h3>
<p>The Picard method iterates on the spatialy discretized equation for a given time step until the difference between the last and new solution match at a given tolerence value.</p>
<p>that is iterates until</p>
<p class="formulaDsp">
\[ u^{n, k+1} = u^{, k} + \textrm{TOL} \]
</p>
<h3>Newton Method</h3>
<p><b>PDE level</b>:</p>
<p class="formulaDsp">
\[ u^{n, k+1} = u^{n, k} + \delta u \]
</p>
<p><b>Algebraic level</b>:</p>
<h3>Generalized method (PDE level)</h3>
<p class="formulaDsp">
\[ \frac{u^{n}-u^{n-1}}{\Delta t} = \nabla\cdot\left(\alpha(u^{n, k}) \nabla u\right) + f(u^{n ,k}) + \gamma\left( \nabla\cdot\left(\alpha&#39;(u^{n, k})\left(u^{n}-u^{n, k}\right) \nabla u^{n,k}\right)+f&#39;(u^{n, k})\left(u^n-u^{n,k}\right)\right) \]
</p>
<p>where the primed quantities represent the derivative with respect to \(u\).</p>
<p>Note that if \(\gamma = 0\), we have the Picard method, and if \(\gamma=1\), we have the Newton method.</p>
<h2><a class="anchor" id="references"></a>
References</h2>
<ol type="1">
<li>H. P. Langtangen and S. Linge. Finite Difference Computing with PDEs: A Modern Software Approach. Springer, 2017. </li>
</ol>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jan 13 2020 23:40:41.
</small></address>
</body>
</html>
